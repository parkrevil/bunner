## 💉 DI (Dependency Injection)

Bunner의 DI 시스템은 런타임 컨테이너의 오버헤드를 제거하고, 컴파일 타임에 확정된 정적 연결(Static Wiring)을 통해 극한의 성능을 제공한다. 특히, 프레임워크 코어와 어댑터의 구분 없이 모든 데코레이터 처리 로직을 **단일 매니페스트 파이프라인**으로 통합하여 일관된 아키텍처를 유지한다.

### Key Philosophy & Features

- **Unified Manifest Architecture (단일 매니페스트 아키텍처):**
  - 프레임워크가 기본으로 제공하는 데코레이터와 어댑터가 제공하는 확장 데코레이터를 구분하지 않는다.
  - 컴파일러는 데코레이터의 의미를 하드코딩하지 않으며, `Common` 패키지와 `Adapter` 패키지가 제공하는 **정적 명세(Manifest)**를 읽어 동일한 로직으로 처리한다. 이를 통해 컴파일러의 복잡도를 낮추고 확장성을 극대화한다.

- **Compile-Time Static Wiring (컴파일 타임 정적 연결):**
  - 애플리케이션 구동 시점에 의존성을 탐색하는 과정(Reflection)을 없앤다.
  - 빌드 시점에 의존성 그래프를 분석하여, 인스턴스를 생성하고 할당하는 최적화된 코드를 미리 작성한다. 런타임에는 단순한 변수 할당과 함수 호출만이 남는다.

- **Function-Based Marker (함수 기반 마커 주입):**
  - 생성자에 의존성을 나열하는 방식 대신, 멤버 필드에서 **의존성 주입 지시 함수**를 호출하는 방식을 사용한다.
  - 이 함수는 런타임 로직을 수행하는 것이 아니라, AOT 컴파일러에게 "이 곳에 특정 구성요소를 주입하라"는 신호를 보내는 마커(Marker) 역할을 수행한다.

- **Scope-Aware Proxy Injection (스코프 인지형 프록시 주입):**
  - 수명 주기가 긴 싱글톤 객체(예: 컨트롤러)가 수명 주기가 짧은 리퀘스트 스코프 객체를 주입받을 때 발생하는 불일치 문제를 자동으로 해결한다.
  - 컴파일러는 이러한 관계를 감지하면, 런타임에 현재 요청 컨텍스트를 동적으로 찾아가는 **고성능 투명 프록시(Transparent Proxy)** 코드를 생성하여 주입한다. 개발자는 스코프 차이를 신경 쓰지 않고 비즈니스 로직을 구현할 수 있다.

### ⚙️ CLI - @bunner/cli

- **Manifest Loader & Processor:**
  - 빌드 초기 단계에 `Common` 패키지와 설치된 `Adapter`들의 매니페스트 파일을 로드하여, 사용 가능한 데코레이터와 주입 규칙을 통합된 딕셔너리로 구축한다.

- **Wiring Code Generator:**
  - 분석된 의존성 그래프를 바탕으로 순수 자바스크립트 팩토리 코드를 생성한다. 의존성 주입 지시 함수가 있던 자리를 실제 인스턴스 참조나 프록시 생성 코드로 1:1 치환한다.

### 📐 Common - @bunner/common

- **Core Manifest Definition:**
  - 프레임워크의 표준 동작을 정의하는 매니페스트를 제공한다. 주입 가능한 구성요소임을 알리는 데코레이터, 스코프 정의, 가시성 설정 등의 규칙이 기술되어 있다.

- **Component Definition Decorator:**
  - 클래스가 DI 시스템에 의해 관리되는 **구성요소(Component)**임을 선언한다. 이 데코레이터를 통해 해당 클래스의 스코프(싱글톤, 요청 단위 등)와 모듈 간 가시성(내부 전용, 외부 공개)을 설정할 수 있다.

- **Dependency Marker Function:**
  - 멤버 변수 초기화 위치에서 사용되어, 구체적인 주입 대상을 컴파일러에게 알리는 역할을 한다. 클래스 참조나 별도의 토큰을 인자로 받아 의존성을 명시한다.

### 💎 Core - @bunner/core

- **Runtime Context Bridge:**
  - `AsyncLocalStorage`를 활용하여 요청별 컨텍스트를 격리하고 관리한다. CLI가 생성한 프록시 객체가 이 브리지를 통해 현재 요청에 해당하는 올바른 인스턴스에 접근할 수 있도록 저수준 API를 제공한다.
